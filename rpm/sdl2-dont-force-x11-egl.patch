From b580d9c4e3661083e9644d5b98ecab70832fd1ac Mon Sep 17 00:00:00 2001
From: "Ryan C. Gordon" <icculus@icculus.org>
Date: Wed, 5 Dec 2018 16:53:15 -0500
Subject: [PATCH] egl: Don't force X11 support when testing for EGL.

Fixes building Wayland support on embedded systems without X11.

(TODO: maybe move the EGL test out of the X11 tests at some point, too.)
---
 configure                            | 1 +
 configure.in                         | 1 +
 src/video/wayland/SDL_waylandvideo.h | 2 +-
 3 files changed, 3 insertions(+), 1 deletion(-)

diff --git a/configure b/configure
index 4f0ffbd83..e4f8e924e 100755
--- a/configure
+++ b/configure
@@ -21814,6 +21814,7 @@ $as_echo_n "checking for EGL support... " >&6; }
 
           #define LINUX
           #define EGL_API_FB
+          #define MESA_EGL_NO_X11_HEADERS
           #include <EGL/egl.h>
           #include <EGL/eglext.h>
 
diff --git a/configure.in b/configure.in
index fbe0583d4..95bef6269 100644
--- a/configure.in
+++ b/configure.in
@@ -2354,6 +2354,7 @@ CheckOpenGLESX11()
         AC_TRY_COMPILE([
           #define LINUX
           #define EGL_API_FB
+          #define MESA_EGL_NO_X11_HEADERS
           #include <EGL/egl.h>
           #include <EGL/eglext.h>
         ],[
diff --git a/src/video/wayland/SDL_waylandvideo.h b/src/video/wayland/SDL_waylandvideo.h
index d173b28e5..0a7c31087 100644
--- a/src/video/wayland/SDL_waylandvideo.h
+++ b/src/video/wayland/SDL_waylandvideo.h
@@ -33,7 +33,7 @@
 !!! FIXME:  in Ubuntu 18.04 (and other distros).
 */
 
-
+#define MESA_EGL_NO_X11_HEADERS
 #include <EGL/egl.h>
 #include "wayland-util.h"
 
